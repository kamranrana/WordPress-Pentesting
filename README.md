# Project 7 - WordPress Pentesting

Time spent: 17 hours spent in total

> Objective: Find, analyze, recreate, and document **five vulnerabilities** affecting an old version of WordPress

## Pentesting Report

1. (Required) Cross-Site Scripting Attack When Creating New Post
  - [X] Summary: This attack is a cross-site scripting attack that allows someone to inject client-side scripts
                 into web pages that are viewed by other WordPress users. This can allow someone to execute 
                 malicious code if another user mistakenly clicks on the page. I found this vunerability [online](https://blog.sucuri.net/2017/09/stored-cross-site-scripting-vulnerability-in-wordpress-4-8-1.html)
    - Vulnerability types: XSS
    - Tested in version: 4.1.21
    - Fixed in version: 4.2.3
  - [X] GIF Walkthrough: ![](https://imgur.com/a/w5IM7P3)
  - [X] Steps to recreate: We will try to recreate this cross-site scripting vunerability using a proof-of-concept approach. 
                           First, we have to login to WordPress using any user account, for me I used an admin account on 
                           my local installation. Next, we go to the "Posts" tab on the left and click on "Add New" in order
                           to create a new post. We give our post a title. Next, we switch the text box where our content is
                           written from "Visual" to "Text". Next, we insert our XSS proof-of-concept such as 
                           `<script type='text/javascript'>alert('XSS');</script>` into our text box with our post content. 
                           Next, we click on the "Preview" button on the right where we will preview our post. Our XSS alert 
                           should come up meaning our malicious code was executed. 
  - [X] Affected source code:
    - [Source Code](https://github.com/WordPress/wordpress-develop/blob/master/src/wp-admin/post.php)
2. (Required) Cross-Site Scripting Attack When Embedding Youtube URL
  - [X] Summary: 
    - Vulnerability types:
    - Tested in version:
    - Fixed in version: 
  - [ ] GIF Walkthrough: 
  - [ ] Steps to recreate: 
  - [ ] Affected source code:
    - [Link 1](https://core.trac.wordpress.org/browser/tags/version/src/source_file.php)
3. (Required) Vulnerability Name or ID
  - [ ] Summary: 
    - Vulnerability types:
    - Tested in version:
    - Fixed in version: 
  - [ ] GIF Walkthrough: 
  - [ ] Steps to recreate: 
  - [ ] Affected source code:
    - [Link 1](https://core.trac.wordpress.org/browser/tags/version/src/source_file.php)
4. (Optional) Vulnerability Name or ID
  - [ ] Summary: 
    - Vulnerability types:
    - Tested in version:
    - Fixed in version: 
  - [ ] GIF Walkthrough: 
  - [ ] Steps to recreate: 
  - [ ] Affected source code:
    - [Link 1](https://core.trac.wordpress.org/browser/tags/version/src/source_file.php)
5. (Optional) Vulnerability Name or ID
  - [ ] Summary: 
    - Vulnerability types:
    - Tested in version:
    - Fixed in version: 
  - [ ] GIF Walkthrough: 
  - [ ] Steps to recreate: 
  - [ ] Affected source code:
    - [Link 1](https://core.trac.wordpress.org/browser/tags/version/src/source_file.php) 

## Assets

The main technique that I used in order to complete this assignment was to find WordPress vunerabilities online
and then to recreate them on my local WordPress installation. I consulted the TAs and they thought that this was
a good technique. The main website which I used to discover WordPress vunerabilities was [this website](https://wpvulndb.com/wordpresses) which I then exploited on my local install. 

## Resources

- [WordPress Vunerability List](https://wpvulndb.com/wordpresses/)
- [WordPress Source Browser](https://core.trac.wordpress.org/browser/)
- [WordPress Developer Reference](https://developer.wordpress.org/reference/)

GIFs created with [LiceCap](http://www.cockos.com/licecap/).

## Notes

One of the main challanges that I encountered while doing this assignment was setting up my Vagrant installation on 
my Windows workstation. 

## License

    Copyright [2018] [Kamran Rana]

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
